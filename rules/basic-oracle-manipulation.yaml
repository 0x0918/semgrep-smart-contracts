rules:
 -
    id: basic-oracle-manipulation
    message: Price oracle can be manipulated via flashloan
    metadata:
        references:
        - https://medium.com/oneringfinance/onering-finance-exploit-post-mortem-after-oshare-hack-602a529db99b
        - https://twitter.com/peckshield/status/1506090607059431427
        - https://ftmscan.io/address/0xc06826f52f29b34c5d8b2c61abf844cebcf7
        - https://pwned-no-more.notion.site/The-Deus-Hack-Explained-647bf97afa2b4e4e9e8b882e68a75c0b
        category: security
        tags:
        - oracle-manipulation
        - flashloan
        - onering-finance
        - deus-finance
        address: 0xc06826f52f29b34c5d8b2c61abf844cebcf78abf
        chain: fantom
        solc: 0.6.12
    patterns:
    - pattern-inside: |
        function $F(...) {
            ...
        }
    - pattern-either:
      - pattern: $X.div($Y)
      - pattern: $X / $Y
    - metavariable-regex:
          metavariable: $F
          regex: (?i)get([a-z0-9_])*price
    languages: 
    - solidity
    severity: INFO

